<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Troubleshooting — troubleshooting • lme4</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Troubleshooting — troubleshooting"><meta name="description" content="This page attempts to summarize some of the common problems with
  fitting [gn]lmer models and how to troubleshoot them.
Most of the symptoms/diagnoses/workarounds listed below are due to
  various issues in the actual mixed model fitting process. You may
  run into problems due to multicollinearity or variables that are
  incorrectly typed (e.g. a variable is accidentally coded as character
  or factor rather than numeric). These problems can often be isolated
  by trying a lm or glm fit or attempting to construct the
  design matrix via model.matrix() (in each case with the random
  effects in your model excluded). If these tests fail then the problem
  is likely not specifically an lme4 issue.

failure to converge in (xxxx) evaluations The
    optimizer hit its maximum limit of function evaluations.  To
    increase this, use the optControl argument of
    [g]lmerControl – for Nelder_Mead and bobyqa
    the relevant parameter is maxfun; for optim and
    optimx-wrapped optimizers, including
    nlminbwrap, it's maxit; for
    nloptwrap, it's maxeval.
Model failed to converge with max|grad| ... The scaled
    gradient at the fitted (RE)ML estimates
    is worryingly large. Try
refitting the parameters starting at the current
      estimates: getting consistent results (with no warning)
      suggests a false positive
switching optimizers: getting consistent
      results suggests there is not really a problem; getting a similar
      log-likelihood with different parameter estimates suggests that
      the parameters are poorly determined (possibly the result of
      a misspecified or overfitted model)
compute values of the deviance in the neighbourhood of the estimated
      parameters to double-check that lme4 has really found a
      local optimum.

Hessian is numerically singular: parameters are not
      uniquely determined
    The Hessian (inverse curvature matrix) at the maximum likelihood or REML
    estimates has a very large eigenvalue, indicating that (within numerical
    tolerances) the surface is completely flat in some direction.
    The model may be misspecified, or extremely badly scaled (see
    &quot;Model is nearly unidentifiable&quot;).
Model is nearly unidentifiable ... Rescale variables?
    The Hessian (inverse curvature matrix) at the maximum likelihood or REML
    estimates has a large eigenvalue, indicating that the surface is
    nearly flat in some direction. Consider centering and/or scaling
    continuous predictor variables.
Contrasts can be applied only to factors with 2 or more levels
    One or more of the categorical predictors in the model has fewer than two
    levels. This may be due to user error when converting these predictors to
    factors prior to modeling, or it may result from some factor levels being
    eliminated due to NAs in other predictors. Double-check the number
    of data points in each factor level to see which one is the culprit:
    lapply(na.omit(df[,vars]), table) (where df is the
    data.frame and vars are the column names of your predictor
    variables).

"><meta property="og:description" content="This page attempts to summarize some of the common problems with
  fitting [gn]lmer models and how to troubleshoot them.
Most of the symptoms/diagnoses/workarounds listed below are due to
  various issues in the actual mixed model fitting process. You may
  run into problems due to multicollinearity or variables that are
  incorrectly typed (e.g. a variable is accidentally coded as character
  or factor rather than numeric). These problems can often be isolated
  by trying a lm or glm fit or attempting to construct the
  design matrix via model.matrix() (in each case with the random
  effects in your model excluded). If these tests fail then the problem
  is likely not specifically an lme4 issue.

failure to converge in (xxxx) evaluations The
    optimizer hit its maximum limit of function evaluations.  To
    increase this, use the optControl argument of
    [g]lmerControl – for Nelder_Mead and bobyqa
    the relevant parameter is maxfun; for optim and
    optimx-wrapped optimizers, including
    nlminbwrap, it's maxit; for
    nloptwrap, it's maxeval.
Model failed to converge with max|grad| ... The scaled
    gradient at the fitted (RE)ML estimates
    is worryingly large. Try
refitting the parameters starting at the current
      estimates: getting consistent results (with no warning)
      suggests a false positive
switching optimizers: getting consistent
      results suggests there is not really a problem; getting a similar
      log-likelihood with different parameter estimates suggests that
      the parameters are poorly determined (possibly the result of
      a misspecified or overfitted model)
compute values of the deviance in the neighbourhood of the estimated
      parameters to double-check that lme4 has really found a
      local optimum.

Hessian is numerically singular: parameters are not
      uniquely determined
    The Hessian (inverse curvature matrix) at the maximum likelihood or REML
    estimates has a very large eigenvalue, indicating that (within numerical
    tolerances) the surface is completely flat in some direction.
    The model may be misspecified, or extremely badly scaled (see
    &quot;Model is nearly unidentifiable&quot;).
Model is nearly unidentifiable ... Rescale variables?
    The Hessian (inverse curvature matrix) at the maximum likelihood or REML
    estimates has a large eigenvalue, indicating that the surface is
    nearly flat in some direction. Consider centering and/or scaling
    continuous predictor variables.
Contrasts can be applied only to factors with 2 or more levels
    One or more of the categorical predictors in the model has fewer than two
    levels. This may be due to user error when converting these predictors to
    factors prior to modeling, or it may result from some factor levels being
    eliminated due to NAs in other predictors. Double-check the number
    of data points in each factor level to see which one is the culprit:
    lapply(na.omit(df[,vars]), table) (where df is the
    data.frame and vars are the column names of your predictor
    variables).

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lme4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-37.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lmer.html">Fitting Linear Mixed-Effects Models using lme4</a></li>
    <li><a class="dropdown-item" href="../articles/lmerperf.html">lme4 performance tips</a></li>
    <li><a class="dropdown-item" href="../articles/PLSvGLS.html">PLS vs GLS for LMMs</a></li>
    <li><a class="dropdown-item" href="../articles/Theory.html">Computational Methods</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lme4/lme4/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Troubleshooting</h1>

      <div class="d-none name"><code>troubleshooting.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This page attempts to summarize some of the common problems with
  fitting <code>[gn]lmer</code> models and how to troubleshoot them.</p>
<p>Most of the symptoms/diagnoses/workarounds listed below are due to
  various issues in the actual mixed model fitting process. You may
  run into problems due to multicollinearity or variables that are
  incorrectly typed (e.g. a variable is accidentally coded as character
  or factor rather than numeric). These problems can often be isolated
  by trying a <code>lm</code> or <code>glm</code> fit or attempting to construct the
  design matrix via <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> (in each case with the random
  effects in your model excluded). If these tests fail then the problem
  is likely not specifically an <code>lme4</code> issue.</p>
<p></p><ul><li><p><code>failure to converge in (xxxx) evaluations</code> The
    optimizer hit its maximum limit of function evaluations.  To
    increase this, use the <code>optControl</code> argument of
    <code>[g]lmerControl</code> – for <code>Nelder_Mead</code> and <code>bobyqa</code>
    the relevant parameter is <code>maxfun</code>; for <code>optim</code> and
    <code>optimx</code>-wrapped optimizers, including
    <code>nlminbwrap</code>, it's <code>maxit</code>; for
    <code>nloptwrap</code>, it's <code>maxeval</code>.</p></li>
<li><p><code>Model failed to converge with max|grad| ...</code> The scaled
    gradient at the fitted (RE)ML estimates
    is worryingly large. Try</p><ul><li><p>refitting the parameters starting at the current
      estimates: getting consistent results (with no warning)
      suggests a false positive</p></li>
<li><p>switching optimizers: getting consistent
      results suggests there is not really a problem; getting a similar
      log-likelihood with different parameter estimates suggests that
      the parameters are poorly determined (possibly the result of
      a misspecified or overfitted model)</p></li>
<li><p>compute values of the deviance in the neighbourhood of the estimated
      parameters to double-check that <code>lme4</code> has really found a
      local optimum.</p></li>
</ul></li>
<li><p><code>Hessian is numerically singular: parameters are not
      uniquely determined</code>
    The Hessian (inverse curvature matrix) at the maximum likelihood or REML
    estimates has a very large eigenvalue, indicating that (within numerical
    tolerances) the surface is completely flat in some direction.
    The model may be misspecified, or extremely badly scaled (see
    <code>"Model is nearly unidentifiable"</code>).</p></li>
<li><p><code>Model is nearly unidentifiable ... Rescale variables?</code>
    The Hessian (inverse curvature matrix) at the maximum likelihood or REML
    estimates has a large eigenvalue, indicating that the surface is
    nearly flat in some direction. Consider centering and/or scaling
    continuous predictor variables.</p></li>
<li><p><code>Contrasts can be applied only to factors with 2 or more levels</code>
    One or more of the categorical predictors in the model has fewer than two
    levels. This may be due to user error when converting these predictors to
    factors prior to modeling, or it may result from some factor levels being
    eliminated due to <code>NA</code>s in other predictors. Double-check the number
    of data points in each factor level to see which one is the culprit:
    <code>lapply(na.omit(df[,vars]), table)</code> (where <code>df</code> is the
    <code>data.frame</code> and <code>vars</code> are the column names of your predictor
    variables).</p></li>
</ul></div>



  </main></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Douglas Bates, Martin Maechler, Ben Bolker, Steven Walker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9007.</p>
</div>

    </footer></div>





  </body></html>

