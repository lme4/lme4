<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Influence Diagnostics for Mixed-Effects Models — influence.merMod • lme4</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Influence Diagnostics for Mixed-Effects Models — influence.merMod"><meta name="description" content="These functions compute deletion influence diagnostics for linear
  (fit by lmer) and generalized linear mixed-effects models
  (fit by glmer).  The main functions are methods for
  the influence generic function.  Other functions are
  provided for computing dfbeta, dfbetas,
  cooks.distance, and influence on variance-covariance
  components based on the objects computed by influence.merMod"><meta property="og:description" content="These functions compute deletion influence diagnostics for linear
  (fit by lmer) and generalized linear mixed-effects models
  (fit by glmer).  The main functions are methods for
  the influence generic function.  Other functions are
  provided for computing dfbeta, dfbetas,
  cooks.distance, and influence on variance-covariance
  components based on the objects computed by influence.merMod"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lme4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-37.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lmer.html">Fitting Linear Mixed-Effects Models using lme4</a></li>
    <li><a class="dropdown-item" href="../articles/lmerperf.html">lme4 performance tips</a></li>
    <li><a class="dropdown-item" href="../articles/PLSvGLS.html">PLS vs GLS for LMMs</a></li>
    <li><a class="dropdown-item" href="../articles/Theory.html">Computational Methods</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lme4/lme4/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Influence Diagnostics for Mixed-Effects Models</h1>

      <div class="d-none name"><code>influence.merMod.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions compute deletion influence diagnostics for linear
  (fit by <code><a href="lmer.html">lmer</a></code>) and generalized linear mixed-effects models
  (fit by <code><a href="glmer.html">glmer</a></code>).  The main functions are methods for
  the <code><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">influence</a></code> generic function.  Other functions are
  provided for computing <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbeta</a></code>, <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbetas</a></code>,
  <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">cooks.distance</a></code>, and influence on variance-covariance
  components based on the objects computed by <code>influence.merMod</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'merMod'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">influence</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">groups</span>, <span class="va">data</span>, maxfun <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>          do.coef <span class="op">=</span> <span class="cn">TRUE</span>, ncores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span>,<span class="fl">1</span><span class="op">)</span>, <span class="va">start</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'influence.merMod'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">cooks.distance</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'influence.merMod'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbeta</a></span><span class="op">(</span><span class="va">model</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fixed"</span>, <span class="st">"var.cov"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'influence.merMod'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbetas</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>in the case of <code>influence.merMod</code>, a model of class <code>"merMod"</code>;
    in the case of <code>cooks.distance</code>, <code>dfbeta</code>, or <code>dfbetas</code>,
    an object returned by <code>influence.merMod</code></p></dd>

  <dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>a character vector containing the name of a grouping factor or names of grouping factors; if more than one name
    is supplied, then groups are defined by all combinations of levels of the grouping factors that appear in
    the data. If omitted, then each individual row of the data matrix is treated as a "group" to be deleted in turn.</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame with the data to which <code>model</code>
    was fit; <code>influence.merMod</code> can usually retrieve the data used to
    fit the model, unless it can't be found in the current environment, so it's usually unnecessary to supply this argument.</p></dd>

  <dt id="arg-maxfun">maxfun<a class="anchor" aria-label="anchor" href="#arg-maxfun"></a></dt>
<dd><p>The maximum number of function evaluations (for <code>influence.merMod</code>)
    to perform after deleting each group; the defaults are large enough so that the iterations will typically continue to convergence.
    Setting to <code>maxfun=20</code> for an <code>lmer</code> model or <code>100</code> for a <code>glmer</code> model will typically produce a faster reasonable approximation.
    An even smaller value can be used if interest is only in influence on the fixed effects.</p></dd>

  <dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>if <code>"fixed.effects"</code> (the default), return influence
    on the fixed effects; if <code>"var.cov"</code>, return influence on the
    variance-covariance components.</p></dd>

  <dt id="arg-do-coef">do.coef<a class="anchor" aria-label="anchor" href="#arg-do-coef"></a></dt>
<dd><p>if <code>FALSE</code>, skip potentially time-consuming
    computations, returning just a list containing hat values.</p></dd>

  <dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>number of computational cores to use if run in parallel;
    directly passed to <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a>()</code> from <span style="R">R</span>'s
    <span class="pkg">parallel</span> package.</p></dd>

  <dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>starting value for new fits (set to optimal values from
    original fit by default)</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>influence.merMod</code> start with the estimated variance-covariance components from <code>model</code> and then refit
the model omitting each group in turn, not necessarily iterating to completion. For example, <code>maxfun=20</code> takes up to 20 function evaluations
step away from the ML or REML solution for the full data, which usually provides decent approximations to the fully iterated estimates.</p>
<p>The other functions are methods for the <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbeta</a></code>, <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbetas</a></code>, and <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">cooks.distance</a></code> generics, to be applied to the
<code>"influence.merMod"</code> object produced by the <code>influence</code> function; the <code>dfbeta</code> methods can also return
influence on the variance-covariance components.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>influence.merMod</code> returns objects of class
  <code>"influence.merMod"</code>, which contain the following elements:</p><dl><dt><code>"fixed.effects"</code></dt>
<dd><p>the estimated fixed effects for the model.</p></dd>

    <dt><code>"fixed.effects[-groups]"</code></dt>
<dd><p>a matrix with columns corresponding to the fixed-effects coefficients and rows corresponding to groups, giving the
    estimated fixed effects with each group deleted in turn; <em>groups</em> is formed from the name(s) of the grouping factor(s).</p></dd>

    <dt><code>"var.cov.comps"</code></dt>
<dd><p>the estimated variance-covariance parameters for the model.</p></dd>

    <dt><code>"var.cov.comps[-groups]"</code></dt>
<dd><p>a matrix with the estimated covariance parameters (in columns) with each group deleted in turn.</p></dd>

    <dt><code>"vcov"</code></dt>
<dd><p>The estimated covariance matrix of the fixed-effects coefficients.</p></dd>

    <dt><code>"vcov[-groups]"</code></dt>
<dd><p>a list each of whose elements is the estimated covariance matrix of the fixed-effects coefficients with one group deleted.</p></dd>

    <dt><code>"groups"</code></dt>
<dd><p>a character vector giving the names of the grouping factors.</p></dd>

    <dt><code>"deleted"</code></dt>
<dd><p>the possibly composite grouping factor, each of whose elements is deleted in turn.</p></dd>

    <dt><code>"converged"</code></dt>
<dd><p>for <code>influence.merMod</code>, a logical vector indicating whether the computation converged for each group.</p></dd>

    <dt><code>"function.evals"</code></dt>
<dd><p>for <code>influence.merMod</code>, a vector of the number of function evaluations performed for each group.</p></dd>


</dl><p>For plotting <code>"influence.merMod"</code> objects, see <code><a href="https://rdrr.io/pkg/car/man/infIndexPlot.html" class="external-link">infIndexPlot</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fox, J. and Weisberg, S. (2019)
  <em>An R Companion to Applied Regression</em>, Third Edition, Sage.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>J. Fox <a href="mailto:jfox@mcmaster.ca">jfox@mcmaster.ca</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/car/man/infIndexPlot.html" class="external-link">infIndexPlot</a></code>, <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">influence.measures</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="lmer.html">lmer</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span> <span class="op">+</span> <span class="op">(</span><span class="va">Days</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span>, <span class="va">sleepstudy</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">inf_fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">influence</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="st">"Subject"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">"car"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/car/man/infIndexPlot.html" class="external-link">infIndexPlot</a></span><span class="op">(</span><span class="va">inf_fm1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbeta</a></span><span class="op">(</span><span class="va">inf_fm1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbetas</a></span><span class="op">(</span><span class="va">inf_fm1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="glmer.html">glmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">incidence</span>, <span class="va">size</span> <span class="op">-</span> <span class="va">incidence</span><span class="op">)</span> <span class="op">~</span> <span class="va">period</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">herd</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               data <span class="op">=</span> <span class="va">cbpp</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">inf_gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">influence</a></span><span class="op">(</span><span class="va">gm1</span>, <span class="st">"herd"</span>, maxfun<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">gm1.11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">gm1</span>, subset <span class="op">=</span> <span class="va">herd</span> <span class="op">!=</span> <span class="fl">11</span><span class="op">)</span> <span class="co"># check deleting herd 11</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">"car"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/car/man/infIndexPlot.html" class="external-link">infIndexPlot</a></span><span class="op">(</span><span class="va">inf_gm1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/car/man/compareCoefs.html" class="external-link">compareCoefs</a></span><span class="op">(</span><span class="va">gm1</span>, <span class="va">gm1.11</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"car"</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="st">"3.0.10"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbeta</a></span><span class="op">(</span><span class="va">inf_gm1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbetas</a></span><span class="op">(</span><span class="va">inf_gm1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span> <span class="op">}</span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Douglas Bates, Martin Maechler, Ben Bolker, Steven Walker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9007.</p>
</div>

    </footer></div>





  </body></html>

