<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Drop all possible single fixed-effect terms from a mixed effect model — drop1.merMod • lme4</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Drop all possible single fixed-effect terms from a mixed effect model — drop1.merMod"><meta name="description" content="Drop allowable single terms from the model: see drop1
  for details of how the appropriate scope for dropping terms
  is determined."><meta property="og:description" content="Drop allowable single terms from the model: see drop1
  for details of how the appropriate scope for dropping terms
  is determined."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lme4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-37.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lmer.html">Fitting Linear Mixed-Effects Models using lme4</a></li>
    <li><a class="dropdown-item" href="../articles/lmerperf.html">lme4 performance tips</a></li>
    <li><a class="dropdown-item" href="../articles/PLSvGLS.html">PLS vs GLS for LMMs</a></li>
    <li><a class="dropdown-item" href="../articles/Theory.html">Computational Methods</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lme4/lme4/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Drop all possible single fixed-effect terms from a mixed effect model</h1>

      <div class="d-none name"><code>drop1.merMod.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Drop allowable single terms from the model: see <code><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></code>
  for details of how the appropriate scope for dropping terms
  is determined.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'merMod'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">scope</span>, scale <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"Chisq"</span>, <span class="st">"user"</span><span class="op">)</span>,</span>
<span>      k <span class="op">=</span> <span class="fl">2</span>, trace <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">sumFun</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a fitted <code>merMod</code> object.</p></dd>

  <dt id="arg-scope">scope<a class="anchor" aria-label="anchor" href="#arg-scope"></a></dt>
<dd><p>a formula giving the terms to be considered for adding or
    dropping.</p></dd>

  <dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Currently ignored (included for S3 method compatibility)</p></dd>

  <dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>should the results include a test statistic relative to the
    original model?
    The \(\chi^2\) test is a likelihood-ratio test,
    which is approximate due to finite-size effects.</p></dd>

  <dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>the penalty constant in AIC</p></dd>

  <dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>print tracing information?</p></dd>

  <dt id="arg-sumfun">sumFun<a class="anchor" aria-label="anchor" href="#arg-sumfun"></a></dt>
<dd><p>a summary <code><a href="https://rdrr.io/r/base/function.html" class="external-link">function</a></code> to be used when
    <code>test=="user"</code>.  It must allow arguments <code>scale</code> and
    <code>k</code>, but these may be ignored (e.g. swallowed by <code>...</code>,
    see the examples).
    The first two arguments must be <code>object</code>, the full model fit,
    and <code>objectDrop</code>, a reduced model.  If <code>objectDrop</code> is missing,
    <code>sumFun(*)</code> should return a vector with the appropriate
    length and names (the actual contents are ignored).</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments (ignored)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>anova</code> summarizing the differences in fit
  between the models.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>drop1</code> relies on being able to find the appropriate information
  within the environment of the formula of the original model.  If the
  formula is created in an environment that does not contain the data,
  or other variables passed to the original model (for example, if
  a separate function is called to define the formula), then
  <code>drop1</code> will fail.  A workaround (see example below) is to
  manually specify an appropriate environment for the formula.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="lmer.html">lmer</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span> <span class="op">+</span> <span class="op">(</span><span class="va">Days</span><span class="op">|</span><span class="va">Subject</span><span class="op">)</span>, <span class="va">sleepstudy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## likelihood ratio tests</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></span><span class="op">(</span><span class="va">fm1</span>,test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Single term deletions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reaction ~ Days + (Days | Subject)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        npar    AIC    LRT   Pr(Chi)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;none&gt;      1763.9                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Days      1 1785.5 23.537 1.226e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="co">## use Kenward-Roger corrected F test, or parametric bootstrap,</span></span></span>
<span class="r-in"><span><span class="co">## to test the significance of each dropped predictor</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://people.math.aau.dk/~sorenh/software/pbkrtest/" class="external-link">pbkrtest</a></span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"pbkrtest"</span><span class="op">)</span><span class="op">&gt;=</span><span class="st">"0.3.8"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">KRSumFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">objectDrop</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">krnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ndf"</span>,<span class="st">"ddf"</span>,<span class="st">"Fstat"</span>,<span class="st">"p.value"</span>,<span class="st">"F.scaling"</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">r</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">objectDrop</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">krnames</span><span class="op">)</span><span class="op">)</span>,<span class="va">krnames</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>         <span class="va">krtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pbkrtest/man/kr__modcomp.html" class="external-link">KRmodcomp</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">objectDrop</span><span class="op">)</span></span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">krtest</span><span class="op">$</span><span class="va">stats</span><span class="op">[</span><span class="va">krnames</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">}</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">r</span>,<span class="st">"method"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Kenward-Roger via pbkrtest package"</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">r</span></span></span>
<span class="r-in"><span>   <span class="op">}</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></span><span class="op">(</span><span class="va">fm1</span>, test<span class="op">=</span><span class="st">"user"</span>, sumFun<span class="op">=</span><span class="va">KRSumFun</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="kw">if</span><span class="op">(</span><span class="fu">lme4</span><span class="fu">:::</span><span class="fu">testLevel</span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span> <span class="co">## takes about 16 sec</span></span></span>
<span class="r-in"><span>     <span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>     <span class="va">PBSumFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">objectDrop</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">pbnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stat"</span>,<span class="st">"p.value"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">objectDrop</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pbnames</span><span class="op">)</span><span class="op">)</span>,<span class="va">pbnames</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">pbtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pbkrtest/man/pb__modcomp.html" class="external-link">PBmodcomp</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">objectDrop</span>,nsim<span class="op">=</span><span class="va">nsim</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pbtest</span><span class="op">$</span><span class="va">test</span><span class="op">[</span><span class="fl">2</span>,<span class="va">pbnames</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">r</span>,<span class="st">"method"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Parametric bootstrap via pbkrtest package"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">r</span></span></span>
<span class="r-in"><span>     <span class="op">}</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></span><span class="op">(</span><span class="va">fm1</span>, test<span class="op">=</span><span class="st">"user"</span>, sumFun<span class="op">=</span><span class="va">PBSumFun</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: pbkrtest</span>
<span class="r-in"><span><span class="co">## workaround for creating a formula in a separate environment</span></span></span>
<span class="r-in"><span><span class="va">createFormula</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">resp</span>, <span class="va">fixed</span>, <span class="va">rand</span><span class="op">)</span> <span class="op">{</span>  </span></span>
<span class="r-in"><span>    <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/delete.response.html" class="external-link">reformulate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fixed</span>,<span class="va">rand</span><span class="op">)</span>,response<span class="op">=</span><span class="va">resp</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## use the parent (createModel) environment, not the</span></span></span>
<span class="r-in"><span>    <span class="co">## environment of this function (which does not contain 'data')</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">f</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">createModel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">mf.final</span> <span class="op">&lt;-</span> <span class="fu">createFormula</span><span class="op">(</span><span class="st">"Reaction"</span>, <span class="st">"Days"</span>, <span class="st">"(Days|Subject)"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="lmer.html">lmer</a></span><span class="op">(</span><span class="va">mf.final</span>, data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></span><span class="op">(</span><span class="fu">createModel</span><span class="op">(</span>data<span class="op">=</span><span class="va">sleepstudy</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Single term deletions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reaction ~ Days + (Days | Subject)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        npar    AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;none&gt;      1763.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Days      1 1785.5</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Douglas Bates, Martin Maechler, Ben Bolker, Steven Walker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9007.</p>
</div>

    </footer></div>





  </body></html>

