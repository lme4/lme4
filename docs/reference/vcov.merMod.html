<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Covariance matrix of estimated parameters — vcov.merMod • lme4</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Covariance matrix of estimated parameters — vcov.merMod"><meta name="description" content="Compute the variance-covariance matrix of estimated paramers.
  Optionally also computes correlations, or the full (joint)
  covariance matrix of the fixed-effect coefficients and the conditional
  modes of the random effects."><meta property="og:description" content="Compute the variance-covariance matrix of estimated paramers.
  Optionally also computes correlations, or the full (joint)
  covariance matrix of the fixed-effect coefficients and the conditional
  modes of the random effects."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lme4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-37.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lmer.html">Fitting Linear Mixed-Effects Models using lme4</a></li>
    <li><a class="dropdown-item" href="../articles/lmerperf.html">lme4 performance tips</a></li>
    <li><a class="dropdown-item" href="../articles/PLSvGLS.html">PLS vs GLS for LMMs</a></li>
    <li><a class="dropdown-item" href="../articles/Theory.html">Computational Methods</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lme4/lme4/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Covariance matrix of estimated parameters</h1>

      <div class="d-none name"><code>vcov.merMod.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the variance-covariance matrix of estimated paramers.
  Optionally also computes correlations, or the full (joint)
  covariance matrix of the fixed-effect coefficients and the conditional
  modes of the random effects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'merMod'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>, correlation <span class="op">=</span> <span class="cn">TRUE</span>, sigm <span class="op">=</span> <span class="fu"><a href="sigma.html">sigma</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>    use.hessian <span class="op">=</span> <span class="cn">NULL</span>, full <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an <span style="R">R</span> object of class <code><a href="merMod-class.html">merMod</a></code>, i.e.,
    as resulting from <code><a href="lmer.html">lmer</a>()</code>, or <code><a href="glmer.html">glmer</a>()</code>,
    etc.</p></dd>

  <dt id="arg-correlation">correlation<a class="anchor" aria-label="anchor" href="#arg-correlation"></a></dt>
<dd><p>(logical)
    indicates whether the correlation matrix as well as
    the variance-covariance matrix is desired</p></dd>

  <dt id="arg-sigm">sigm<a class="anchor" aria-label="anchor" href="#arg-sigm"></a></dt>
<dd><p>the residual standard error; by default <code><a href="sigma.html">sigma</a>(object)</code>.</p></dd>

  <dt id="arg-use-hessian">use.hessian<a class="anchor" aria-label="anchor" href="#arg-use-hessian"></a></dt>
<dd><p>(logical) indicates whether to use the
    finite-difference Hessian of the deviance function to compute
    standard errors of the fixed effects. See <em>Details</em>.</p></dd>

  <dt id="arg-full">full<a class="anchor" aria-label="anchor" href="#arg-full"></a></dt>
<dd><p>return the 'full' covariance matrix, i.e. the joint
    covariance matrix of the conditional distribution of conditional
    modes (as in <code>getME(., "b")</code>) and fixed-effect
    parameters. (<code>correlation</code> and <code>use.hessian</code> are
    <em>ignored</em> in this case.)</p>
<p>Note that this option may be slow for models with large numbers of
  random-effect levels!</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>extra arguments for method compatibility (ignored)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When <code>use.hessian = FALSE</code>, the code estimates the
  covariance matrix based on internal information about the inverse of
  the model matrix (see <code><a href="getME.html">getME</a>(.,"RX")</code>). This is exact for
  linear mixed models, but approximate for GLMMs.
  The default is to use the Hessian whenever the
  fixed effect parameters are arguments to the deviance
  function (i.e. for GLMMs with <code>nAGQ&gt;0</code>), and to use
  <code><a href="getME.html">getME</a>(.,"RX")</code> whenever the fixed effect parameters are
  profiled out (i.e. for GLMMs with <code>nAGQ==0</code> or LMMs).</p>
<p><code>use.hessian=FALSE</code> is backward-compatible with older versions
  of <code>lme4</code>, but may give less accurate SE estimates when the
  estimates of the fixed-effect (see <code><a href="getME.html">getME</a>(.,"beta")</code>)
  and random-effect (see <code><a href="getME.html">getME</a>(.,"theta")</code>) parameters
  are correlated.</p>
<p>However, <code>use.hessian=TRUE</code> is not always more accurate: for some
  numerically unstable fits, the approximation using <code>RX</code> is
  actually more reliable (because the Hessian has to be computed by
  a finite difference approximation, which is also error-prone): see
  e.g. <a href="https://github.com/lme4/lme4/issues/720" class="external-link">https://github.com/lme4/lme4/issues/720</a></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a covariance matrix (sparse when <code>full=TRUE</code>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="lmer.html">lmer</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span> <span class="op">+</span> <span class="op">(</span><span class="va">Days</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span>, <span class="va">sleepstudy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="glmer.html">glmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">incidence</span>, <span class="va">size</span> <span class="op">-</span> <span class="va">incidence</span><span class="op">)</span> <span class="op">~</span> <span class="va">period</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">herd</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             data <span class="op">=</span> <span class="va">cbpp</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 x 2 Matrix of class "dpoMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)      Days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   46.575120 -1.451088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Days          -1.451088  2.389466</span>
<span class="r-in"><span><span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fm1</span>, correlation <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># extract the hidden 'correlation' entry in @factors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">v2</span>, <span class="st">"corMatrix"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 x 2 Matrix of class "corMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)       Days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   1.0000000 -0.1375519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Days         -0.1375519  1.0000000</span>
<span class="r-in"><span><span class="va">v3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">gm1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">v3X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">gm1</span>, use.hessian  <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>variance-covariance matrix computed from finite-difference Hessian</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> and from RX differ by &gt;1e-04: consider 'use.hessian=TRUE'</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">v3</span>, <span class="va">v3X</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Mean relative difference: 0.02937752"</span>
<span class="r-in"><span><span class="co">## full correlatiom matrix</span></span></span>
<span class="r-in"><span><span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fm1</span>, full <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">cv</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span></span>
<span class="r-in"><span>      scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="vcov.merMod-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Douglas Bates, Martin Maechler, Ben Bolker, Steven Walker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9007.</p>
</div>

    </footer></div>





  </body></html>

